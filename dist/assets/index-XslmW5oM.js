(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();const E=[{id:"1",title:"YouTube",url:"https://youtube.com",icon:"https://www.youtube.com/favicon.ico"},{id:"2",title:"Jellyfin",url:"http://localhost:8096",icon:"/favicon.ico"},{id:"3",title:"Twitch",url:"https://twitch.tv",icon:"https://www.twitch.tv/favicon.ico"},{id:"4",title:"Plex",url:"https://app.plex.tv",icon:"https://www.plex.tv/favicon.ico"}];class k{shortcuts=[];customGreeting=null;storageKey="hometab_shortcuts";greetingKey="hometab_greeting";constructor(){this.loadShortcuts(),this.loadGreeting()}async loadGreeting(){if(typeof chrome<"u"&&chrome.storage&&chrome.storage.sync){const t=await chrome.storage.sync.get(this.greetingKey);this.customGreeting=t[this.greetingKey]||null}else if(typeof chrome<"u"&&chrome.storage&&chrome.storage.local){const t=await chrome.storage.local.get(this.greetingKey);this.customGreeting=t[this.greetingKey]||null}else{const t=localStorage.getItem(this.greetingKey);this.customGreeting=t||null}return this.customGreeting}async saveGreeting(t){this.customGreeting=t,typeof chrome<"u"&&chrome.storage&&chrome.storage.sync?await chrome.storage.sync.set({[this.greetingKey]:this.customGreeting}):typeof chrome<"u"&&chrome.storage&&chrome.storage.local?await chrome.storage.local.set({[this.greetingKey]:this.customGreeting}):t?localStorage.setItem(this.greetingKey,t):localStorage.removeItem(this.greetingKey)}getGreeting(){return this.customGreeting}async loadShortcuts(){if(typeof chrome<"u"&&chrome.storage&&chrome.storage.sync){let e=(await chrome.storage.sync.get(this.storageKey))[this.storageKey];if(!e||e.length===0){const s=(await chrome.storage.local.get(this.storageKey))[this.storageKey];s&&s.length>0&&(console.log("Migrating shortcuts from Local to Sync storage..."),e=s,await chrome.storage.sync.set({[this.storageKey]:e}))}this.shortcuts=e||E}else if(typeof chrome<"u"&&chrome.storage&&chrome.storage.local){const t=await chrome.storage.local.get(this.storageKey);this.shortcuts=t[this.storageKey]||E}else{const t=localStorage.getItem(this.storageKey);this.shortcuts=t?JSON.parse(t):E}return this.shortcuts}async saveShortcuts(){typeof chrome<"u"&&chrome.storage&&chrome.storage.sync?await chrome.storage.sync.set({[this.storageKey]:this.shortcuts}):typeof chrome<"u"&&chrome.storage&&chrome.storage.local?await chrome.storage.local.set({[this.storageKey]:this.shortcuts}):localStorage.setItem(this.storageKey,JSON.stringify(this.shortcuts))}getShortcuts(){return this.shortcuts}addShortcut(t){this.shortcuts.push(t),this.saveShortcuts()}updateShortcut(t){const e=this.shortcuts.findIndex(r=>r.id===t.id);e!==-1&&(this.shortcuts[e]=t,this.saveShortcuts())}removeShortcut(t){this.shortcuts=this.shortcuts.filter(e=>e.id!==t),this.saveShortcuts()}async getMetadata(t){try{const r=new URL(t.startsWith("http")?t:`https://${t}`).hostname,s=`https://www.google.com/s2/favicons?domain=${r}&sz=128`;let n=r.replace("www.","").split(".")[0];return n=n.charAt(0).toUpperCase()+n.slice(1),{title:n,icon:s}}catch{return{title:"Shortcut",icon:"/vite.svg"}}}}class A{currentIndex=0;itemCount=0;columns=4;onFocusChange;onEnter;constructor(t,e){this.onFocusChange=t,this.onEnter=e,this.initListeners()}setItems(t,e){this.itemCount=t,this.columns=e,this.currentIndex>=this.itemCount&&(this.currentIndex=this.itemCount-1),this.currentIndex<0&&(this.currentIndex=0)}initListeners(){window.addEventListener("keydown",t=>this.handleKey(t))}handleKey(t){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&t.preventDefault();let e=this.currentIndex;switch(t.key){case"ArrowRight":e++;break;case"ArrowLeft":e--;break;case"ArrowDown":e+=this.columns;break;case"ArrowUp":e-=this.columns;break;case"Enter":this.onEnter(this.currentIndex);return}e>=0&&e<this.itemCount&&(this.currentIndex=e,this.onFocusChange(this.currentIndex))}resetFocus(){this.currentIndex=0,this.onFocusChange(0)}}const I=document.getElementById("app-grid"),a=document.getElementById("greeting"),B=document.getElementById("clock"),T=document.getElementById("settings-btn"),S=document.getElementById("modal-overlay"),K=document.getElementById("modal-title"),h=document.getElementById("url-input"),g=document.getElementById("title-input"),m=document.getElementById("logo-input"),M=document.getElementById("save-btn"),N=document.getElementById("cancel-btn"),l=new k;let u,i=[],c=!1,y=null;function w(o){if(I.innerHTML="",o.forEach((t,e)=>{const r=document.createElement("div");r.className="app-card",r.dataset.index=e.toString();const s=t.icon||"/vite.svg",n=document.createElement("div");if(n.className="badge-container",n.style.display="none",c){const d=document.createElement("div");d.className="delete-badge",d.innerText="X",d.onclick=v=>{v.stopPropagation(),U(t.id)};const p=document.createElement("div");p.className="edit-badge",p.innerText="âœŽ",p.onclick=v=>{v.stopPropagation(),D(t)},n.appendChild(p),n.appendChild(d),n.style.display="flex"}r.innerHTML=`
      <img src="${s}" alt="${t.title}" onerror="this.src='/vite.svg'">
      <span>${t.title}</span>
    `,r.appendChild(n),r.onclick=()=>{c||x(e)},I.appendChild(r)}),c){const t=document.createElement("div");t.className="app-card add-card",t.innerHTML="<span>+</span>",t.onclick=()=>F(),I.appendChild(t)}}function L(o){const t=document.querySelectorAll(".app-card");t.forEach(e=>e.classList.remove("focused")),t[o]&&(t[o].classList.add("focused"),t[o].scrollIntoView({block:"nearest",behavior:"smooth"}))}function x(o){if(c)return;const t=i[o];t&&(window.location.href=t.url)}function O(){c=!c,document.body.classList.toggle("edit-mode",c),c?(a.contentEditable="true",a.classList.add("editable"),a.focus()):(a.contentEditable="false",a.classList.remove("editable"),l.saveGreeting(a.textContent)),w(i);const o=c?i.length+1:i.length;u.setItems(o,f())}async function U(o){confirm("Delete shortcut?")&&(l.removeShortcut(o),i=l.getShortcuts(),w(i),u.setItems(c?i.length+1:i.length,f()))}function F(){y=null,K.innerText="Add Shortcut",h.value="",g.value="",m.value="",S.classList.add("open"),h.focus()}function D(o){y=o.id,K.innerText="Edit Shortcut",h.value=o.url,g.value=o.title,m.value=o.icon||"",S.classList.add("open"),h.focus()}function G(){S.classList.remove("open")}async function b(){const o=h.value.trim();if(!o)return;const t=o.startsWith("http")?o:`https://${o}`;let e=g.value.trim();const r=m.value.trim();let s=r;if(!e||!s&&!r){const n=await l.getMetadata(t);e||(e=n.title),s||(s=n.icon)}if(y){const n={id:y,title:e,url:t,icon:s};l.updateShortcut(n)}else{const n={id:Date.now().toString(),title:e,url:t,icon:s};l.addShortcut(n)}i=l.getShortcuts(),G(),w(i),u.setItems(c?i.length+1:i.length,f())}function f(){return window.innerWidth<=600?2:window.innerWidth<=900?3:4}function P(){if(u){const o=c?i.length+1:i.length;u.setItems(o,f())}}function C(){const o=new Date;B.textContent=o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});const t=o.getHours();let e="Good Evening";t<12?e="Good Morning":t<18&&(e="Good Afternoon");const r=l.getGreeting();r&&r.trim()!==""?!c&&document.activeElement!==a&&(a.textContent=r):c||(a.textContent=`${e}, User`)}async function R(){i=await l.loadShortcuts();const o=await l.loadGreeting();w(i),u=new A(L,x),u.setItems(i.length,f()),L(0),window.addEventListener("resize",P),T.addEventListener("click",O),N.addEventListener("click",G),M.addEventListener("click",b),h.addEventListener("keydown",t=>{t.key==="Enter"&&g.focus()}),g.addEventListener("keydown",t=>{t.key==="Enter"&&m.focus()}),m.addEventListener("keydown",t=>{t.key==="Enter"&&b()}),o&&(a.textContent=o),C(),setInterval(C,6e4)}R();
